import{m as A,u as E,r as x,j as P,o as l,c as d,f as k,a as t,d as a,n as h,x as m,F as $,l as I,t as p,g as S,T as V,y,e as U,z as N,A as D}from"./index-4f3fb0fd.js";import{_ as K}from"./Navbar-059a5560.js";import{_ as G}from"./_plugin-vue_export-helper-c27b6911.js";const c=w=>(N("data-v-e28921c0"),w=w(),D(),w),H={class:"container mx-auto px-4 sm:px-6 lg:px-8"},Y={class:"flex flex-col lg:flex-row lg:justify-between"},F={class:"w-full lg:w-2/3"},W={class:"flex flex-col mt-8"},Q={class:"flex justify-between"},X=c(()=>t("h2",{class:"text-lg font-medium leading-6 text-gray-900"},"Shopping Cart",-1)),J={key:0},Z={class:"flex-1 mt-4"},tt={class:"overflow-x-auto"},et={class:"min-w-full divide-y divide-gray-200"},st=c(()=>t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase"}," Product "),t("th",{scope:"col",class:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase"}," Price "),t("th",{scope:"col",class:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase"}," Quantity "),t("th",{scope:"col",class:"px-6 py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase"}," Total "),t("th",{scope:"col",class:"relative px-6 py-3"},[t("span",{class:"sr-only"},"Remove")])])],-1)),ot={class:"bg-white divide-y divide-gray-200"},at={class:"px-6 py-4 whitespace-nowrap"},nt={class:"flex items-center"},rt={class:"flex-shrink-0 w-10 h-10"},ct=["src"],it={class:"ml-4"},lt={class:"text-sm font-medium text-gray-900"},dt={class:"text-sm text-gray-500"},ut={class:"px-6 py-4 whitespace-nowrap"},pt={class:"text-sm text-gray-900"},ft={class:"px-6 py-4 whitespace-nowrap"},gt={class:"flex items-center justify-between w-24"},ht=["onClick"],_t=c(()=>t("svg",{class:"w-4 h-4 fill-current",viewBox:"0 0 20 20"},[t("path",{d:"M5 10h10v1H5z"})],-1)),mt=[_t],yt={class:"text-gray-700"},xt=["onClick"],wt=c(()=>t("svg",{class:"w-4 h-4 fill-current",viewBox:"0 0 20 20"},[t("path",{d:"M10 5v10h1V5z"}),t("path",{d:"M5 10h10v1H5z"})],-1)),vt=[wt],bt={class:"px-6 py-4 whitespace-nowrap"},kt={class:"text-sm text-gray-900"},Ct={class:"px-6 py-4 whitespace-nowrap"},$t=["onClick"],St=c(()=>t("svg",{class:"w-4 h-4 fill-current",viewBox:"0 0 20 20"},[t("path",{d:"M10 18a8 8 0 100-16 8 8 0 000 16zM6.3 6.3a1 1 0 011.4 0L10 8.6l2.3-2.3a1 1 0 011.4 1.4L11.4 10l2.3 2.3a1 1 0 01-1.4 1.4L10 11.4l-2.3 2.3a1 1 0 01-1.4-1.4L8.6 10 6.3 7.7a1 1 0 010-1.4z"})],-1)),Lt=[St],Tt={class:"w-full lg:w-1/3 mt-8 lg:mt-0"},Mt={class:"bg-white p-4 rounded-md shadow-md"},Ot=c(()=>t("h3",{class:"text-lg font-medium leading-6 text-gray-900"},"Summary",-1)),Bt={class:"mt-4"},zt={class:"flex justify-between text-sm font-medium text-gray-600"},Rt=c(()=>t("span",null,"Subtotal:",-1)),jt=c(()=>t("div",{class:"flex justify-between mt-2 text-sm font-medium text-gray-600"},[t("span",null,"Shipping:"),t("span",null,"$0.00")],-1)),qt=c(()=>t("hr",{class:"mt-2 mb-4"},null,-1)),At={class:"flex justify-between text-lg font-medium text-gray-900"},Et=c(()=>t("span",null,"Total:",-1)),Pt={key:0},It=c(()=>t("div",{id:"mp"},null,-1)),Vt={key:0},Ut={key:0,class:"flex mt-2 mb-2 custom-error"},Nt={style:{width:"95%","text-align":"center","text-transform":"uppercase"},class:"mt-2 mb-2"},Dt={key:0},Kt={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center"},Gt=c(()=>t("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75"},null,-1)),Ht=c(()=>t("div",{class:"flex items-center justify-center w-12 h-12 mx-auto mb-4 text-green-500 bg-green-100 rounded-full"},[t("svg",{class:"w-6 h-6 fill-current",viewBox:"0 0 20 20"},[t("path",{d:"M17.707 4.293c-.391-.391-1.023-.391-1.414 0l-7.293 7.293-3.293-3.293c-.391-.391-1.023-.391-1.414 0-.391.391-.391 1.023 0 1.414l4 4c.195.195.451.293.707.293s.512-.098.707-.293l8-8c.391-.391.391-1.023 0-1.414z"})])],-1)),Yt=c(()=>t("p",{class:"text-lg font-medium text-gray-800"},"Purchase completed! We will shortly be sending you an email with the details.",-1)),Ft={class:"mt-6"},Wt={class:"px-4 py-2 text-sm font-medium text-white bg-green-500 rounded hover:bg-green-600 focus:outline-none focus:ring focus:ring-green-500"},Qt={key:1},Xt={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center"},Jt=c(()=>t("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75"},null,-1)),Zt=c(()=>t("div",{class:"flex items-center justify-center w-12 h-12 mx-auto mb-4 text-green-500 bg-green-100 rounded-full"},[t("svg",{class:"w-6 h-6 fill-current",viewBox:"0 0 20 20"},[t("path",{d:"M17.707 4.293c-.391-.391-1.023-.391-1.414 0l-7.293 7.293-3.293-3.293c-.391-.391-1.023-.391-1.414 0-.391.391-.391 1.023 0 1.414l4 4c.195.195.451.293.707.293s.512-.098.707-.293l8-8c.391-.391.391-1.023 0-1.414z"})])],-1)),te=c(()=>t("p",{class:"text-lg font-medium text-gray-800"},"Your purchase was successful! Although due to lack of stock some of your products could not be included. Don't worry, you can continue shopping and we will notify you when there is stock!. ",-1)),ee={class:"mt-6"},se={__name:"ShopCartView",setup(w){const r=A(),u=E();let _=x(0),C=x(!1),f=x(!1),g="",v=x(!1),b=x(!1);function L(){f.value=!1,g=""}async function T(n){const s=r.productsOnCart.find(i=>i._id===n);console.log(s);const o=`https://backend-production-2f21.up.railway.app/api/carts/${r.cart_id}/products/${n}`,e=await y.put(o,{quantity:"1"});if(e.data&&e.data.status==!0){s.quantity++;const i=await s.price;_.value+=await i}else f.value=!0,g="There was an error trying to increase"}async function M(n){const s=`https://backend-production-2f21.up.railway.app/api/carts/${r.cart_id}/products/${n}`,o=await y.delete(s,{});o.data?o.data.status==!0?r.productsOnCart=r.productsOnCart.filter(e=>e._id!=n):alert(o.data.message):alert("the action could not be completed")}async function O(n){const s=r.productsOnCart.find(o=>o._id===n);if(s.quantity>1){const o=`https://backend-production-2f21.up.railway.app/api/carts/${r.cart_id}/products/${n}`,e=await y.put(o,{quantity:"-1"});if(e.data&&e.data.status==!0){s.quantity--;const i=await s.price;_.value-=await i}else f.value=!0,g="There was an error trying to decrement quantity"}}async function B(){const n=r.cart_id;try{const s=`https://backend-production-2f21.up.railway.app/api/carts/${n}`,o=await y.delete(s);o.data&&o.data.status==!0?(r.productsOnCart=[],_.value=0):(f.value=!0,g="There was an error trying to remove products from the cart")}catch{f.value=!0,g="There was an error trying to remove products from the cart"}}async function z(){b.value=!1,v.value=!1}async function R(){const n=r.cart_id,s=new MercadoPago("TEST-9a6af9fc-8332-4bc2-8364-65d306126962",{locale:"en-US"});try{const o=`https://backend-production-2f21.up.railway.app/api/carts/${n}/create_preference`,e=await y.post(o);if(console.log(e),console.log(e.data),console.log(e.data.preference_id),e&&e.data.preference_id){const i=e.data.preference_id;console.log(i),s.bricks().create("wallet","mp",{initialization:{preferenceId:i,redirectMode:"modal"},callbacks:{onReady:()=>{console.log("ON READY CALLBACK ")},onSubmit:()=>{console.log("ON SUBMIT CALLBACK "),C.value=!0},onError:q=>console.error(q)}})}}catch(o){console.log(o)}}async function j(){const n=r.cart_id;if(console.log(n),n)try{const s=`https://backend-production-2f21.up.railway.app/api/carts/${n}/purchase`,o=await y.post(s);if(console.log(o),o&&o.data.status==!1&&o.data.pending_payment==!0){Swal.fire({title:"Error!",text:"Payment required!",icon:"error",confirmButtonText:"OK"});return}}catch(s){console.log(s),g="There was an error trying to finish purchase.",f.value=!0}else Swal.fire({title:"Error!",text:"There was an error trying to finish purchase. cart id not found. Please login again and retry your purchase.",icon:"error",confirmButtonText:"OK"})}return r.productsOnCart.forEach(n=>{console.log("total exec"),_.value+=n.price*n.quantity}),(n,s)=>{const o=P("RouterLink");return l(),d($,null,[k(K),t("div",H,[t("div",Y,[t("div",F,[t("div",W,[t("div",Q,[X,a(u).user.role=="user"||a(u).user.role=="premium"?(l(),d("div",J,[t("button",{onClick:s[0]||(s[0]=e=>B()),class:h(a(r).productsOnCart.length>0?"mt-4 p-4 bg-gray-600 mr-2 text-white text-center py-2 rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-50":" disabled-opacity-50 mt-4 p-4 bg-gray-600 mr-2 text-white text-center py-2 rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-50")}," Empty Cart ",2)])):m("",!0)]),t("div",Z,[t("div",tt,[t("table",et,[st,t("tbody",ot,[(l(!0),d($,null,I(a(r).productsOnCart,e=>(l(),d("tr",null,[t("td",at,[t("div",nt,[t("div",rt,[t("img",{class:"w-full h-full object-contain rounded-md",src:e.thumbnails,alt:""},null,8,ct)]),t("div",it,[t("div",lt,p(e.productName),1),t("div",dt,p(e.type),1)])])]),t("td",ut,[t("div",pt,p(e.price),1)]),t("td",ft,[t("div",gt,[t("button",{class:"text-gray-500 hover:text-gray-700",onClick:i=>O(e._id),"aria-label":"Decrease quantity"},mt,8,ht),t("span",yt,p(e.quantity),1),t("button",{class:"text-gray-500 hover:text-gray-700",onClick:i=>T(e._id),"aria-label":"Increase quantity"},vt,8,xt)])]),t("td",bt,[t("div",kt,"$"+p(Math.round(e.quantity*e.price*1e12)/1e12),1)]),t("td",Ct,[t("button",{class:"text-gray-500 hover:text-gray-700",onClick:i=>M(e._id),"aria-label":"Remove item"},Lt,8,$t)])]))),256))])])])])])]),t("div",Tt,[t("div",Mt,[Ot,t("div",Bt,[t("div",zt,[Rt,t("span",null,"$"+p(Math.round(a(_)*1e11)/1e11),1)]),jt,qt,t("div",At,[Et,t("span",null,"$"+p(Math.round(a(_)*1e11)/1e11),1)]),a(u).user.role=="user"||a(u).user.role=="premium"?(l(),d("div",Pt,[t("button",{onClick:R,class:h(a(r).productsOnCart.length>0?"mt-4 w-full bg-gray-800 text-white text-center py-2 rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-50":" mt-4 w-full bg-gray-800 text-white text-center py-2 rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-50 disabled-opacity-50")}," PAY WITH MERCADOPAGO ",2),It,a(C)?(l(),d("div",Vt,[t("button",{onClick:j,class:h(a(r).productsOnCart.length>0?"mt-4 w-full bg-gray-800 text-white text-center py-2 rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-50":" mt-4 w-full bg-gray-800 text-white text-center py-2 rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-50 disabled-opacity-50")}," Checkout ",2)])):m("",!0)])):m("",!0)])])])])]),k(V,{name:"fade",duration:{enter:"1000",leave:"2000"}},{default:S(()=>[a(f)?(l(),d("div",Ut,[t("div",Nt,p(a(g)),1),t("button",{style:{width:"5%"},class:"",onClick:L},"X")])):m("",!0)]),_:1}),a(u).user.role=="user"||a(u).user.role=="premium"?(l(),d("div",Dt,[t("div",{class:h([a(v)?"scale-100":"","fixed scale-0 z-10 inset-0 overflow-y-auto"])},[t("div",Kt,[Gt,t("div",{class:h([a(v)?"scale-100":"","transform scale-0 transition-transform duration-300 relative z-10 w-full max-w-md p-6 bg-white rounded-lg shadow-lg"])},[Ht,Yt,t("div",Ft,[t("button",Wt,[k(o,{onClick:a(r).clearCart,to:"/"},{default:S(()=>[U("Go Back to shopping")]),_:1},8,["onClick"])])])],2)])],2)])):m("",!0),a(u).user.role=="user"||a(u).user.role=="premium"?(l(),d("div",Qt,[t("div",{class:h([a(b)?"scale-100":"","fixed scale-0 z-10 inset-0 overflow-y-auto"])},[t("div",Xt,[Jt,t("div",{class:h([a(b)?"scale-100":"","transform scale-0 transition-transform duration-300 relative z-10 w-full max-w-md p-6 bg-white rounded-lg shadow-lg"])},[Zt,te,t("div",ee,[t("button",{onClick:s[1]||(s[1]=e=>z()),class:"px-4 py-2 text-sm font-medium text-white bg-green-500 rounded hover:bg-green-600 focus:outline-none focus:ring focus:ring-green-500"}," Go Back to shopping ")])],2)])],2)])):m("",!0)],64)}}},re=G(se,[["__scopeId","data-v-e28921c0"]]);export{re as default};
